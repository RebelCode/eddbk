!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.stdLib={})}(this,function(e){"use strict";var u=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},i=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),r=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},n=function(){function n(e,t,r){if(u(this,n),!e)throw new Error("Getter must be provided");if(!t)throw new Error("Setter must be provided");if(!r)throw new Error("Key getter must be provided");this._itemsGetter=e,this._itemsSetter=t,this._keyGetter=r}return i(n,[{key:"_setItems",value:function(e){this._itemsSetter(e)}},{key:"_getItems",value:function(){return this._itemsGetter()}},{key:"getItems",value:function(){return Object.assign({},this._getItems())}},{key:"addItem",value:function(e){var t=this._getItems();t=this._addItem(t,e),this._setItems(t)}},{key:"hasItem",value:function(e){return!!this._getItems()[this._keyGetter(e)]}},{key:"removeItem",value:function(e){var t=this._getItems();t=this._removeItem(t,e),this._setItems(t)}},{key:"_addItem",value:function(e,t){e=Object.assign({},e);var r=this._keyGetter(t);if(e[r])throw new Error("Item with id "+r+" already exists");return e[r]=t,e}},{key:"_removeItem",value:function(e,t){return delete(e=Object.assign({},e))[this._keyGetter(t)],e}},{key:"_addItems",value:function(e,t){for(var r in t)this._addItem(e,t[r]);return e}}]),n}(),t=function(e){function t(){return u(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return r(t,n),i(t,[{key:"getItems",value:function(){return this._getItems().slice()}},{key:"hasItem",value:function(e){var t=null,r=this._getItems(),n=this._keyGetter(e);for(var i in r)if(this._keyGetter(r[i])===n){t=i;break}return null!==t}},{key:"_addItem",value:function(e,t){return(e=e.slice()).push(t),e}},{key:"_removeItem",value:function(e,t){var r=null,n=this._keyGetter(t);for(var i in e)if(this._keyGetter(e[i])==n){r=i;break}return null!==r&&e.splice(r,1),e}}]),t}(),o="throw",c="prepend",s=function(e){function s(e,t,r,n,i){if(u(this,s),!n)throw new Error("Collection limit must be provided");if(!i)throw new Error("Overflow mode for collection must be provided");var o=a(this,(s.__proto__||Object.getPrototypeOf(s)).call(this,e,t,r));if(-1===o._getAllowedOverflowModes().indexOf(i))throw new Error("Wrong overflow mode is provided");return o._limit=n,o._overflowMode=i,o._checkOverflow(),o}return r(s,t),i(s,[{key:"_getAllowedOverflowModes",value:function(){return[o,c]}},{key:"_addItem",value:function(e,t){if(e.length+1>this._limit)switch(this._overflowMode){case o:throw new Error("Limited collection can hold not more that "+this._limit+" items");case c:return this._addItemToStart(e,t)}return(e=e.slice()).push(t),e}},{key:"_addItemToStart",value:function(e,t){return void 0!==this._lastAddedIndex&&this._lastAddedIndex!=e.length-1||(this._lastAddedIndex=-1),this._lastAddedIndex++,(e=e.slice())[this._lastAddedIndex]=t,e}},{key:"_checkOverflow",value:function(){var e=this._getItems();if(!(e.length<=this._limit))switch(this._overflowMode){case o:throw new Error("Limited collection can hold not more that "+this._limit+" items");case c:this._setItems(e.slice(this._limit))}}}]),s}(),l=function(e){function o(e,t,r,n){if(u(this,o),!n)throw new Error("Item allowed checker must be provided");var i=a(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,e,t,r));return i._itemAllowed=n,i}return r(o,t),i(o,[{key:"isAllowed",value:function(e){return this._itemAllowed(this.getItems(),e)}}]),o}(),h=function(){function r(e,t){u(this,r),this._stateSetter=e,this._stateGetter=t}return i(r,[{key:"_setState",value:function(e){this._stateSetter(!!e)}},{key:"_getState",value:function(){return this._stateGetter()}},{key:"isOn",value:function(){return!!this._getState()}},{key:"setState",value:function(e){this._setState(!!e)}}]),r}(),f=function(){function r(e,t){u(this,r),this.id=e,this.template=t}return i(r,[{key:"render",value:function(e){return this.template}}]),r}(),d=function(){function n(e,t,r){u(this,n),this.http=e,this.config=t,this.cache=r}return i(n,[{key:"prepareParams",value:function(e){return e}}]),n}(),_=function(){function t(e){u(this,t),this.hashCode=e,this._cache={}}return i(t,[{key:"remember",value:function(t,e){var r=this;return this.has(t)?new Promise(function(e){e(r.get(t))}):e().then(function(e){return r.set(t,e),e})}},{key:"set",value:function(e,t){this._cache[this._getCacheKey(e)]=t}},{key:"has",value:function(e){return!!this._cache[this._getCacheKey(e)]}},{key:"get",value:function(e){return this._cache[this._getCacheKey(e)]}},{key:"_getCacheKey",value:function(t){var r={};return Object.keys(t).sort().map(function(e){r[e]=t[e]}),this.hashCode(JSON.stringify(r))}}]),t}(),m=function(){function e(){u(this,e),this.rules={}}return i(e,[{key:"transform",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=!0,n=!1,i=void 0;try{for(var o,s=Object.keys(this.rules)[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value,a=this.rules[u];e.hasOwnProperty(u)&&(e=a(e=Object.assign({},e),t))}}catch(e){n=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(n)throw i}}return e}}]),e}();e.FunctionalCollection=n,e.FunctionalArrayCollection=t,e.FunctionalLimitedCollection=s,e.FLC_OVERFLOW_THROW=o,e.FLC_OVERFLOW_PREPEND=c,e.FunctionalRestrictedCollection=l,e.FunctionalToggleable=h,e.Page=f,e.Api=d,e.RequestCache=_,e.Transformer=m,e.makeCreateInTimezone=function(i){return function(e,t){var r=i.parseZone(e);if(0!==t.indexOf("UTC"))return i.tz(r,t);var n=Number(t.replace(/UTC\+?/g,""));return r.utcOffset(n)}},e.makeParseInTimezone=function(i,o){return function(e,t){var r=i.parseZone(e);if(0!==t.indexOf("UTC"))return i.tz(r.format(o),o,t);var n=Number(t.replace(/UTC\+?/g,""));return r.utcOffset(n,!0)}},Object.defineProperty(e,"__esModule",{value:!0})});
